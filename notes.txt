- confirm that a general trivy scan picks up the OWASP 2 issues, not needing a scan targeting a particular image
- confirm that using `wall` is a good method to notify users (might need testing on iximiuz)...probably in plan mode to research a bit
- if we wanted to make this capable of running in a multi-node k3s cluster, would there be any benefit from a learning objectives perspective? ie, would that change any of the actual commands (do the scan commands work the same, and are the remediations the same...also have an agent ultrathink about that)?
- also have an agent plan out if we're missing any unit tests, or if we need to update any to reflect current functionality
- set up a test iximiuz playground, and snapshot it so you can just load it and start up. We'll need k3s and all the scanner installed.
- confirm that we wouldn't get any benefit from suggesting to scan with kube-hunter and kube-score

---
potential alternate approach for notifications (this is in the setup script for the iximiuz labs cluster):

```
#!/bin/bash
# File: file-watcher.sh

set -eu

MESSAGE="File /tmp/cluster-status has been modified!"

inotifywait -m -e modify,create,move /tmp/cluster-status 2>/dev/null | while IFS= read -r line; do
  MESSAGE=$(cat /tmp/cluster-status 2>/dev/null || echo "File not readable")
  /opt/send-message.sh "$MESSAGE"
  echo "Notification sent at $(date)"
done
```

also a systemd unit file for the above:

```
[Unit]
Description=File Watcher Service
After=network.target

[Service]
Type=simple
User=root
ExecStart=/opt/file-watcher.sh
Restart=always
RestartSec=5

[Install]
WantedBy=multi-user.target
```

and the sendmessage function script at `/opt/send-message.sh`:

```
#!/bin/bash
# Comprehensive non-blocking message broadcast

message="${1:-System message}"

# Function to safely send non-blocking message
safe_message() {
    local term="$1"
    local msg="$2"
    # Save cursor, move to new line, print, restore cursor
    printf "\033[s\033[999B\n\033[1;33m%s\033[0m\n\033[u" "$msg" > "$term" 2>/dev/null
}

export -f safe_message

# Send to all available terminals
find /dev/pts -name "[0-9]*" 2>/dev/null | while read term; do
    if [ -w "$term" ]; then
        safe_message "$term" "$message" &
    fi
done

# Also try traditional terminals
find /dev -name "tty[0-9]*" 2>/dev/null | while read term; do
    if [ -w "$term" ]; then
        safe_message "$term" "$message" &
    fi
done
```
